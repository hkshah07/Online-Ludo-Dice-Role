<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo Dice Pro - ‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§™‡§æ‡§∞‡•ç‡§ü‡§®‡§∞</title>
    <style>
        :root { --p1: #e74c3c; --p2: #3498db; --p3: #2ecc71; --p4: #f1c40f; --p5: #9b59b6; --p6: #e67e22; }
        body { font-family: sans-serif; background: #121212; color: white; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* ‡§∏‡§ø‡§ü‡§ø‡§Ç‡§ó ‡§Ö‡§∞‡•á‡§Ç‡§ú‡§Æ‡•á‡§Ç‡§ü */
        .player-row { display: flex; width: 100%; padding: 10px 0; background: #1a1a1a; min-height: 80px; }
        #top-players { justify-content: space-around; flex-direction: row; }
        #bottom-players { justify-content: space-around; flex-direction: row-reverse; } /* Clockwise ‡§ï‡•á ‡§≤‡§ø‡§è reverse */
        
        .player-unit { text-align: center; width: 30%; padding: 5px; border-radius: 10px; border: 2px solid transparent; transition: 0.3s; }
        .active { border-color: white; background: rgba(255,255,255,0.15); box-shadow: 0 0 10px white; }
        
        .center-area { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        #dice { font-size: 110px; background: white; color: black; width: 130px; height: 130px; display: flex; align-items: center; justify-content: center; border-radius: 20px; box-shadow: 0 0 40px rgba(255,255,255,0.1); }
        
        .rolling-anim { animation: jump-roll 1s ease-in-out; }
        @keyframes jump-roll {
            0% { transform: translateY(120px) rotate(0deg) scale(0.5); opacity: 0.2; }
            50% { transform: translateY(-40px) rotate(360deg) scale(1.3); opacity: 1; }
            100% { transform: translateY(0) rotate(720deg) scale(1); }
        }

        .btn-group { display: flex; gap: 3px; margin-top: 5px; }
        .roll-btn { border: none; padding: 12px 5px; border-radius: 5px; color: white; font-weight: bold; flex: 2; font-size: 12px; }
        .off-btn { background: #444; border: none; padding: 12px 5px; border-radius: 5px; color: white; flex: 1; font-size: 10px; }
        button:disabled { opacity: 0.1; }

        .stats-bar { display: flex; justify-content: space-between; padding: 8px 20px; background: #222; font-size: 14px; border-bottom: 1px solid #333; }
        .history-container { flex: 1; background: #1a1a1a; overflow-y: auto; border-top: 2px solid #333; }
        table { width: 100%; border-collapse: collapse; text-align: center; }
        th { font-size: 11px; color: #888; position: sticky; top: 0; background: #1a1a1a; padding: 8px; border-bottom: 2px solid #333; }
        td { border-bottom: 1px solid #2a2a2a; padding: 10px; font-weight: bold; font-size: 15px; }
        .round-tag { color: #f1c40f; font-weight: normal; font-size: 12px; }

        .setup-screen { position: fixed; inset: 0; background: #121212; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div id="setup" class="setup-screen">
        <h1 style="color:var(--p1); letter-spacing: 2px;">LUDO DICE</h1>
        <div style="display: grid; grid-template-columns: 1fr; gap: 15px; width: 200px;">
            <button onclick="startGame(2)" style="background:var(--p2); padding:15px; color:white; border:none; border-radius:10px; font-weight:bold;">2 PLAYERS</button>
            <button onclick="startGame(4)" style="background:var(--p1); padding:15px; color:white; border:none; border-radius:10px; font-weight:bold;">4 PLAYERS</button>
            <button onclick="startGame(6)" style="background:var(--p3); padding:15px; color:white; border:none; border-radius:10px; font-weight:bold;">6 PLAYERS</button>
        </div>
    </div>

    <div id="top-players" class="player-row"></div>

    <div class="stats-bar">
        <span id="timer">‚è≥ 00:00</span>
        <span id="mute-btn" onclick="toggleMute()" style="cursor:pointer; font-size: 20px;">üîä</span>
    </div>

    <div class="center-area">
        <div id="dice">‚öÄ</div>
    </div>

    <div id="bottom-players" class="player-row"></div>

    <div class="history-container">
        <table>
            <thead><tr id="history-header"></tr></thead>
            <tbody id="history-body"></tbody>
        </table>
    </div>

    <script>
        let players = [];
        let turn = 0;
        let roundCount = 1;
        let seconds = 0;
        let isMuted = false;
        let sixCount = 0;
        const diceIcons = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
        const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f1c40f', '#9b59b6', '#e67e22'];

        // ‡§∏‡§æ‡§â‡§Ç‡§° ‡§ú‡§®‡§∞‡•á‡§ü‡§∞ (‡§¨‡§ø‡§®‡§æ ‡§´‡§æ‡§á‡§≤ ‡§ï‡•á)
        function playDiceSound() {
            if (isMuted) return;
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            oscillator.type = 'square';
            oscillator.frequency.setValueAtTime(150, audioCtx.currentTime);
            oscillator.frequency.exponentialRampToValueAtTime(40, audioCtx.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.1);

            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            oscillator.start();
            oscillator.stop(audioCtx.currentTime + 0.1);
        }

        function startGame(num) {
            const topDiv = document.getElementById('top-players');
            const botDiv = document.getElementById('bottom-players');
            const header = document.getElementById('history-header');
            header.innerHTML = '<th>ROUND</th>';

            for(let i=0; i<num; i++) {
                players.push({ name: 'P'+(i+1), isOut: false });
                const pUI = `
                    <div class="player-unit" id="player-${i}">
                        <div style="font-size:11px; color:${colors[i]}">PLAYER ${i+1}</div>
                        <div class="btn-group">
                            <button id="btn-${i}" class="roll-btn" style="background:${colors[i]}" onclick="roll(${i})">ROLL</button>
                            <button id="off-${i}" class="off-btn" onclick="rollOff(${i})">STOP</button>
                        </div>
                    </div>`;
                
                if (i < num/2) topDiv.innerHTML += pUI;
                else botDiv.innerHTML += pUI;

                header.innerHTML += `<th style="color:${colors[i]}">P${i+1}</th>`;
            }
            document.getElementById('setup').style.display = 'none';
            setInterval(() => { seconds++; updateTimer(); }, 1000);
            updateUI();
        }

        function updateTimer() {
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `‚è≥ ${m}:${s}`;
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('mute-btn').innerText = isMuted ? 'üîá' : 'üîä';
        }

        function rollOff(idx) {
            players[idx].isOut = true;
            nextTurn();
            updateUI();
        }

        function roll(idx) {
            playDiceSound();
            const dice = document.getElementById('dice');
            dice.classList.remove('rolling-anim');
            void dice.offsetWidth;
            dice.classList.add('rolling-anim');

            document.querySelectorAll('button').forEach(b => b.disabled = true);

            setTimeout(() => {
                const val = Math.floor(Math.random() * 6) + 1;
                dice.innerHTML = diceIcons[val-1];
                updateHistory(idx, val);

                if (val === 6 && sixCount < 2) {
                    sixCount++;
                } else {
                    sixCount = 0;
                    nextTurn();
                }
                updateUI();
            }, 1000);
        }

        function nextTurn() {
            let startTurn = turn;
            do {
                turn = (turn + 1) % players.length;
                if (turn === 0) roundCount++; 
            } while (players[turn].isOut && players.some(p => !p.isOut));
        }

        function updateUI() {
            players.forEach((p, i) => {
                const unit = document.getElementById(`player-${i}`);
                unit.classList.toggle('active', i === turn && !p.isOut);
                document.getElementById(`btn-${i}`).disabled = (i !== turn || p.isOut);
                document.getElementById(`off-${i}`).disabled = (i !== turn || p.isOut);
                if(p.isOut) {
                    unit.style.opacity = "0.2";
                    unit.style.filter = "grayscale(1)";
                }
            });
        }

        function updateHistory(pIdx, val) {
            const tbody = document.getElementById('history-body');
            let rows = tbody.getElementsByTagName('tr');
            
            // ‡§®‡§Ø‡§æ ‡§∞‡§æ‡§â‡§Ç‡§° ‡§Ø‡§æ ‡§™‡§π‡§≤‡•Ä ‡§è‡§Ç‡§ü‡•ç‡§∞‡•Ä
            if (pIdx === 0 || rows.length === 0) {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `<td class="round-tag">R${roundCount}</td>`;
                for(let i=0; i<players.length; i++) newRow.innerHTML += `<td>-</td>`;
                tbody.insertBefore(newRow, tbody.firstChild);
                rows = tbody.getElementsByTagName('tr');
            }

            const currentCell = rows[0].getElementsByTagName('td')[pIdx + 1];
            if (currentCell.innerText === '-') currentCell.innerText = val;
            else currentCell.innerText += `, ${val}`;
        }
    </script>
</body>
</html>
