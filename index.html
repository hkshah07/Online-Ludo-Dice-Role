<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ludo Dice Pro - ‡§ï‡•ã‡§°‡§ø‡§Ç‡§ó ‡§™‡§æ‡§∞‡•ç‡§ü‡§®‡§∞</title>
    <style>
        :root { --p1: #e74c3c; --p2: #3498db; --p3: #2ecc71; --p4: #f1c40f; --p5: #9b59b6; --p6: #e67e22; }
        body { font-family: sans-serif; background: #121212; color: white; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* ‡§ü‡•â‡§™ ‡§î‡§∞ ‡§¨‡•â‡§ü‡§Æ ‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® */
        .player-row { display: flex; justify-content: space-around; width: 100%; padding: 10px 0; background: #1a1a1a; }
        .player-unit { text-align: center; width: 45%; padding: 8px; border-radius: 10px; border: 2px solid transparent; }
        .active { border-color: white; background: rgba(255,255,255,0.1); }
        
        /* ‡§∏‡•á‡§Ç‡§ü‡§∞ ‡§è‡§∞‡§ø‡§Ø‡§æ (Dice & Timer) */
        .center-area { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        #dice { font-size: 110px; background: white; color: black; width: 120px; height: 120px; display: flex; align-items: center; justify-content: center; border-radius: 20px; box-shadow: 0 0 30px rgba(0,0,0,0.5); z-index: 5; }
        .rolling-anim { animation: jump-roll 1s ease-in-out; }
        @keyframes jump-roll {
            0% { transform: translateY(150px) rotate(0deg) scale(0.5); opacity: 0; }
            50% { transform: translateY(-30px) rotate(360deg) scale(1.3); opacity: 1; }
            100% { transform: translateY(0) rotate(720deg) scale(1); }
        }

        /* ‡§ï‡§Ç‡§ü‡•ç‡§∞‡•ã‡§≤ ‡§¨‡§ü‡§®‡•ç‡§∏ */
        .btn-group { display: flex; gap: 5px; margin-top: 5px; }
        .roll-btn { border: none; padding: 10px; border-radius: 5px; color: white; font-weight: bold; flex: 2; }
        .off-btn { background: #444; border: none; padding: 10px; border-radius: 5px; color: white; flex: 1; font-size: 10px; }
        button:disabled { opacity: 0.2; }

        /* ‡§π‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä ‡§î‡§∞ ‡§∏‡•ç‡§ü‡•á‡§ü‡§∏ */
        .stats-bar { display: flex; justify-content: space-between; padding: 10px 20px; background: #222; font-size: 14px; }
        .history-container { flex: 0.8; background: #1a1a1a; overflow-y: auto; padding: 5px; border-top: 2px solid #333; }
        table { width: 100%; border-collapse: collapse; text-align: center; }
        th { font-size: 11px; color: #aaa; position: sticky; top: 0; background: #1a1a1a; padding: 5px; }
        td { border-bottom: 1px solid #333; padding: 8px; font-weight: bold; }
        .round-col { color: var(--p4); font-size: 12px; }

        .setup-screen { position: fixed; inset: 0; background: #121212; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div id="setup" class="setup-screen">
        <h1>LUDO DICE</h1>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <button onclick="startGame(2)" style="background:var(--p1); padding:20px; color:white; border:none; border-radius:10px;">2 Player</button>
            <button onclick="startGame(4)" style="background:var(--p2); padding:20px; color:white; border:none; border-radius:10px;">4 Player</button>
            <button onclick="startGame(6)" style="background:var(--p3); padding:20px; color:white; border:none; border-radius:10px;">6 Player</button>
        </div>
    </div>

    <div id="top-players" class="player-row"></div>

    <div class="stats-bar">
        <span id="timer">‡§∏‡§Æ‡§Ø: 00:00</span>
        <span id="mute-btn" onclick="toggleMute()" style="cursor:pointer; font-size: 20px;">üîä</span>
    </div>
    <div class="center-area">
        <div id="dice">‚öÄ</div>
    </div>

    <div id="bottom-players" class="player-row"></div>

    <div class="history-container">
        <table>
            <thead><tr id="history-header"></tr></thead>
            <tbody id="history-body"></tbody>
        </table>
    </div>

    <script>
        let players = [];
        let turn = 0;
        let roundCount = 0;
        let seconds = 0;
        let isMuted = false;
        let sixCount = 0;
        const diceIcons = ['‚öÄ', '‚öÅ', '‚öÇ', '‚öÉ', '‚öÑ', '‚öÖ'];
        const colors = ['#e74c3c', '#3498db', '#2ecc71', '#f1c40f', '#9b59b6', '#e67e22'];
        
        // ‡§∏‡§æ‡§â‡§Ç‡§° ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ë‡§°‡§ø‡§Ø‡•ã ‡§ë‡§¨‡•ç‡§ú‡•á‡§ï‡•ç‡§ü
        const rollSound = new Audio('https://www.soundjay.com/misc/sounds/dice-roll-1.mp3');

        function startGame(num) {
            const topDiv = document.getElementById('top-players');
            const botDiv = document.getElementById('bottom-players');
            const header = document.getElementById('history-header');
            header.innerHTML = '<th>RD</th>';

            for(let i=0; i<num; i++) {
                players.push({ name: 'P'+(i+1), isOut: false });
                const pUI = `
                    <div class="player-unit" id="player-${i}">
                        <div style="font-size:12px">Player ${i+1}</div>
                        <div class="btn-group">
                            <button id="btn-${i}" class="roll-btn" style="background:${colors[i]}" onclick="roll(${i})">ROLL</button>
                            <button id="off-${i}" class="off-btn" onclick="rollOff(${i})">STOP</button>
                        </div>
                    </div>`;
                
                // ‡§Ü‡§ß‡•á ‡§ä‡§™‡§∞, ‡§Ü‡§ß‡•á ‡§®‡•Ä‡§ö‡•á (Even check)
                if (i < num/2) topDiv.innerHTML += pUI;
                else botDiv.innerHTML += pUI;

                header.innerHTML += `<th style="color:${colors[i]}">P${i+1}</th>`;
            }
            document.getElementById('setup').style.display = 'none';
            setInterval(() => { seconds++; updateTimer(); }, 1000);
            updateUI();
        }

        function updateTimer() {
            const m = Math.floor(seconds / 60).toString().padStart(2, '0');
            const s = (seconds % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `‡§∏‡§Æ‡§Ø: ${m}:${s}`;
        }

        function toggleMute() {
            isMuted = !isMuted;
            document.getElementById('mute-btn').innerText = isMuted ? 'üîá' : 'üîä';
        }

        function rollOff(idx) {
            players[idx].isOut = true;
            nextTurn();
        }

        function roll(idx) {
            if(!isMuted) rollSound.play();
            const dice = document.getElementById('dice');
            dice.classList.remove('rolling-anim');
            void dice.offsetWidth;
            dice.classList.add('rolling-anim');

            document.querySelectorAll('button').forEach(b => b.disabled = true);

            setTimeout(() => {
                const val = Math.floor(Math.random() * 6) + 1;
                dice.innerHTML = diceIcons[val-1];
                updateHistory(idx, val);

                if (val === 6 && sixCount < 2) {
                    sixCount++;
                } else {
                    sixCount = 0;
                    nextTurn();
                }
                updateUI();
            }, 1000);
        }

        function nextTurn() {
            let startTurn = turn;
            do {
                turn = (turn + 1) % players.length;
                if (turn === 0) roundCount++; // ‡§™‡§π‡§≤‡•á ‡§™‡•ç‡§≤‡•á‡§Ø‡§∞ ‡§™‡§∞ ‡§Ü‡§§‡•á ‡§π‡•Ä ‡§∞‡§æ‡§â‡§Ç‡§° ‡§ï‡§æ‡§â‡§Ç‡§ü
            } while (players[turn].isOut && turn !== startTurn);
        }

        function updateUI() {
            players.forEach((p, i) => {
                const unit = document.getElementById(`player-${i}`);
                unit.classList.toggle('active', i === turn && !p.isOut);
                document.getElementById(`btn-${i}`).disabled = (i !== turn || p.isOut);
                document.getElementById(`off-${i}`).disabled = (i !== turn || p.isOut);
                if(p.isOut) unit.style.opacity = "0.3";
            });
        }

        function updateHistory(pIdx, val) {
            const tbody = document.getElementById('history-body');
            let rows = tbody.getElementsByTagName('tr');
            
            // ‡§Ö‡§ó‡§∞ ‡§®‡§Ø‡§æ ‡§∞‡§æ‡§â‡§Ç‡§° ‡§π‡•à ‡§Ø‡§æ ‡§ï‡•ã‡§à ‡§∞‡•ã ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à
            if (pIdx === 0 || rows.length === 0) {
                const newRow = document.createElement('tr');
                newRow.innerHTML = `<td class="round-col">R${roundCount+1}</td>`;
                for(let i=0; i<players.length; i++) newRow.innerHTML += `<td>-</td>`;
                tbody.insertBefore(newRow, tbody.firstChild);
                rows = tbody.getElementsByTagName('tr');
            }

            const cells = rows[0].getElementsByTagName('td');
            const currentCell = cells[pIdx + 1]; // +1 because index 0 is Round column
            
            if (currentCell.innerText === '-') currentCell.innerText = val;
            else currentCell.innerText += `, ${val}`;
        }
    </script>
</body>
</html>
